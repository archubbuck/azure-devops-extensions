<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Notification Hub Action</title>
    <script src="./SDK.min.js"></script>
  </head>
  <body>
    <script>
      // Initialize the SDK and open the panel
      SDK.init({ loaded: true, applyTheme: true }).then(function() {
        SDK.ready().then(function() {
          console.log('[Notification Hub Action] Opening panel...');
          
          // Derive the panel contribution ID from the extension context
          var extensionContext = SDK.getExtensionContext();
          var panelContributionId = extensionContext.id + ".notification-hub-panel";
          
          console.log('[Notification Hub Action] Panel ID: ' + panelContributionId);
          
          // Get the host page layout service
          SDK.getService("ms.vss-features.host-page-layout-service").then(function(layoutService) {
            // Open the panel using the dynamically derived contribution ID
            layoutService.openPanel(panelContributionId, {
              title: "Notifications",
              size: 1 // PanelSize.Medium (enum value)
            });
            console.log('[Notification Hub Action] Panel opened successfully');
            SDK.notifyLoadSucceeded();
          }).catch(function(error) {
            console.error('[Notification Hub Action] Failed to open panel:', error);
            SDK.notifyLoadFailed('Failed to open panel: ' + error.message);
          });
        });
      }).catch(function(error) {
        console.error('[Notification Hub Action] Failed to initialize SDK:', error);
        SDK.notifyLoadFailed('Failed to initialize SDK: ' + error.message);
      });
    </script>
  </body>
</html>
